<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Redirecting...</title>
</head>
<body>
    <p id="tmp">Redirecting to ...</p>
    <script>
        
        function redirect(paths) {
            // Get the query parameters from the current URL
            const label = document.getElementById('tmp');
            const params = new URLSearchParams(window.location.search);
            const ksValue = params.get('s') || '';
            if(paths[ksValue] === undefined) {
                label.innerHTML = 'Unknown URL!'
                return;
            }
            const targetUrl = paths[ksValue];
            const queryParams = window.location.search;

            // Combine the target URL with query parameters
            const redirectUrl = targetUrl + queryParams;
            label.innerHTML = `Redirecting to ${redirectUrl} ...`;
            window.location.href = redirectUrl;
        }

        async function getLinks() {
            try {
                const response = await fetch('links.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                return response.json();
            } catch (error) {
                console.error('Error fetching or parsing JSON:', error);
                return [];
            }
        }

        // https://pangz-lab.github.io/link?s=verusbox.discord
        getLinks().then((p) => redirect(p));
    </script>
</body>
</html>